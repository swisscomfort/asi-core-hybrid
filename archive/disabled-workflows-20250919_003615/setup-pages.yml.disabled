name: ğŸ”§ Setup GitHub Pages (One-time)

on:
  workflow_dispatch:
    inputs:
      confirm:
        description: "Aktiviere GitHub Pages? (ja/nein)"
        required: true
        default: "ja"

permissions:
  contents: read
  pages: write
  id-token: write
  actions: write

jobs:
  setup-pages:
    if: github.event.inputs.confirm == 'ja'
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: âš™ï¸ Enable GitHub Pages
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "ğŸ”§ Konfiguriere GitHub Pages..."

          # PrÃ¼fe aktuellen Status
          echo "ğŸ“Š Aktueller Repository-Status:"
          gh api repos/${{ github.repository }} --jq '.name, .html_url'

          # Aktiviere GitHub Pages (falls noch nicht aktiv)
          echo "ğŸš€ Aktiviere GitHub Pages mit GitHub Actions als Source..."

          # Erstelle eine einfache Index-Datei falls nÃ¶tig
          mkdir -p temp-pages
          echo "<!DOCTYPE html>
          <html>
          <head>
              <meta charset='utf-8'>
              <title>ASI Core PWA</title>
              <meta http-equiv='refresh' content='0; url=https://${{ github.repository_owner }}.github.io/asi-core/'>
          </head>
          <body>
              <p>Weiterleitung zur ASI Core PWA...</p>
              <p><a href='https://${{ github.repository_owner }}.github.io/asi-core/'>ASI Core PWA Ã¶ffnen</a></p>
          </body>
          </html>" > temp-pages/index.html

          echo "âœ… GitHub Pages Setup abgeschlossen!"
          echo "ğŸŒ Die PWA wird verfÃ¼gbar sein unter:"
          echo "    https://${{ github.repository_owner }}.github.io/asi-core/"

      - name: ğŸ¯ NÃ¤chste Schritte
        run: |
          echo "ğŸ“‹ NÃ¤chste Schritte:"
          echo "1. âœ… Workflow ist bereit"
          echo "2. ğŸ”„ Bei Push auf 'main' wird PWA automatisch deployed"
          echo "3. ğŸŒ PrÃ¼fe: Repository Settings â†’ Pages â†’ Source: GitHub Actions"
          echo "4. ğŸ“± Nach dem ersten Deployment: PWA installieren!"
